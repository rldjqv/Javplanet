<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.javplanet.api.board.dao.BoardDao">

	<sql id="conditions">
		<if test="data.seq != null and data.seq != ''">
			AND seq = #{data.seq}			
		</if>		
	</sql>
	
	<select id="getBoards" parameterType="kr.co.javplanet.api.board.model.BoardParam" resultType="kr.co.javplanet.api.board.dto.Board">
		SELECT /* board.xml : getBoards */
			seq,
			userId,
			type,
			title,
			contents,
			viewCount,
			up,
			down,
			delYN,
			DATE_FORMAT(regDate, '%m-%d') as regDate
		FROM jav_board
		WHERE 1=1
		<include refid="conditions"/>
		ORDER BY seq DESC
	</select>
	
	<select id="getBoardDetail" parameterType="kr.co.javplanet.api.board.model.BoardParam" resultType="kr.co.javplanet.api.board.dto.Board">
		SELECT /* board.xml : getBoardDetail */
			seq,
			userId,
			type,
			title,
			contents,
			viewCount,
			up,
			down,
			userIp,
			delYN,
			modId,
			modDate,
			DATE_FORMAT(regDate, '%y-%m-%d %H:%i') as regDate
		FROM jav_board
		WHERE 1=1
		<include refid="conditions"/>
	</select>
	
	<update id="putBoardDetailViewCount" parameterType="kr.co.javplanet.api.board.model.BoardParam">
		UPDATE /* board.xml : putBoardDetailViewCount */
			jav_board
		SET
			viewCount = viewCount + 1
		WHERE 1=1
		<include refid="conditions"/>
	</update>
</mapper>